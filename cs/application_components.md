# 애플리케이션 구성 요소 (Application Components)

애플리케이션이 사용자에게 제공할 수 있는 진입점을 **구성 요소**라고 부른다.
안드로이드의 대표적인 구성 요소에는 `액티비티`,`서비스`,`브로드캐스트 리시버`,`콘텐츠 프로바이더`의 4종류가 있다.
각 구성요소는 각각의 목적을 갖고, 각기 다른 LifeCycle을 가진다.

## 액티비티 (Activity)

액티비티는 **사용자와 상호 작용하기 위한 진입점**이다.
UI를 포함하고 있는 화면 하나를 가리키며, 액티비티끼리는 독립적이나 상호 협력적으로 작동한다.
액티비티는 LIFO 구조의 STACK 형태로 관리되며, STACK 내의 액티비티는 프로세스 유지에 상대적으로 높은 우선순위를 가질 수 있다.

## 서비스 (Service)

서비스는 **백그라운드**에서 앱을 실행하기 위한 **진입점**이며, UI를 갖지 않는다.
오랫동안 실행되는 작업(음악 재생)이나 비동기 네트워크 작업(메신저 수신)에 사용된다.

시스템에 의해 관리되는 방식에 따라 서비스는 크게 **두 종류**로 나뉜다

1. **Started Services**
작업이 종료될 때 까지 지속적으로 실행되는 서비스이다. 백그라운드 데이터 동기화나 음악 재생 등이 속할 수 있다.
두 작업을 위한 서비스에도 차이점이 존재한다.

   - **포그라운드 서비스** : 음악 재생은 사용자에게 인식되는 작업으로, 지속적으로 작업에 대한 알림을 보내고 시스템은 프로세스가 계속 실행되도록 관리한다.
   - **백그라운드 서비스** : 정기적 데이터 동기화는 사용자가 인식할 수 없는 작업이므로, 시스템은 사용자가 더 인식하기 쉬운 작업을 먼저 처리하기 위해 서비스를 종료할 수 있다. (이후 서비스가 다시 실행되도록 설정할 수도 있다)
  
2. **Bound Service**
다른 앱 또는 서비스에 의해 실행된 서비스이다. 때문에 시스템은 두 서로 다른 프로세스 사이의 종속성을 인식하고 프로세스 유지 우선순위를 관리하게 된다.

## 브로드캐스트 리시버 (Broadcast Receiver)

브로드캐스트 리시버는 **시스템이 이벤트를 앱에 전달**하도록 돕는 구성요소이다.
앱이 실행중이 아닐 때도 앱의 진입점으로 동작할 수 있다.
일반적으로 다른 구성요소로 연결되며 작동한다. (Broadcast에 의한 Service 시작)
브로드캐스트 메시지는 `Intent`개체로 래핑되어 전달되며 브로드캐스트 리시버는 `Intetn-filter`를 사용하여 원하는 브로드캐스트를 수신하는 방식이다.
`에어플레인_활성화`,`시간_변화`,`전원_연결`등 다양한 이벤트를 수신할 수 있다.

## 콘텐츠 프로바이더 (Content Provider)

콘텐츠 프로바이더는 `파일 시스템`,`SQLite`,`웹` 등에 저장된 **공유용 앱 데이터를 관리**한다.
콘텐츠 프로바이더의 설정에 따라 데이터의 접근 또는 수정이 가능하다.
`URI` 구성표로 식별되어 **데이터에 접근하기 위한 앱의 진입점**이 된다.
데이터 제공 앱은 `URI`에 의해 실행되어 데이터를 `게시`하게 되고, 데이터 요청 앱은 `URI`를 통해 데이터에 접근할 수 있게 된다.
이 때 요청 앱이 얻는 것은 `URI`에 대한 **임시 접근 권한**으로, 데이터 공유의 중요한 보안 모델이 된다.

예를 들어 앱에서 촬영 사진을 활용하기 위해 `촬영 콘텐츠 프로바이더`를 호출할 수 있고, 해당 역할을 수행하는 콘텐츠 프로바이더를 내포한 앱을 호출하여 데이터를 반환받을 수 있게 되는 것이다.

## 구성 요소 활성화

구성 요소 중 `액티비티`,`서비스`,`Broadcast Receiver`는 `인텐트(intent)`라는 비동기식 메시지로 활성화할 수 있다.
인텐트는 런타임 중에 각 구성요소를 바인딩하게 된다.
인텐트는 `명시적 인텐트`와 `암시적 인텐트`로 나뉘는데, 명시적 인텐트는 특정 구성 요소(특정 액티비티 등)의 실행을 명시적으로 표현하나, 암시적 인텐트는 구성 요소의 특정 유형(ex 사진을 촬영하는 액티비티 아무거나~!)의 실행을 요청하는 인텐트이다.

`액티비티`와 `서비스`의 경우 인텐트는 수행 작업을 정의하며(ex 무언가를 보내는 작업), 시작되는 구성요소에게 필요한 데이터의 URI를 포함한 정보를 전달한다.
`Broadcast Receiver`는 단순히 인텐트를 통해 브로드캐스트될 알림을 전달받는다. 이 인텐트를 받은 `Broadcast Receiver`가 다른 구성요소를 호출하는 것이 가능하다.

`Content Provider`는 인텐트에 의해 활성화되지 않고, `ContentResolver`가 보낸 요청의 대상으로 지정되면 활성화된다.
이렇게 제공자와 요청자 사이에 `ContentResolver`라는 추상화 계층을 갖게 되어 보안 면에서 이점을 취할 수 있다.

이러한 구성 요소는 애플리케이션의 `AndroidManifest.xml`에 등록하여 시스템에게 구성 요소의 존재를 알릴 수 있다.

- **안드로이드 매니페스트**
    Android 애플리케이션은 애플리케이션의 구성 요소, 권한 및 기타 메타데이터를 선언하는 매니페스트 파일을 갖는다. 매니페스트 파일은 Android 시스템에 필수 정보를 제공하여 애플리케이션을 적절하게 시작하고 관리할 수 있도록 한다.